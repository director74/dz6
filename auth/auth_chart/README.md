# Auth Service Helm Chart

Этот Helm чарт развертывает сервис аутентификации и авторизации в Kubernetes.

## Компоненты чарта

- **Deployment** - запускает поды с сервисом аутентификации
- **Service** - предоставляет доступ к сервису внутри кластера
- **ConfigMap** - содержит конфигурацию сервиса
- **Secret** - хранит чувствительные данные (пароли, ключи)
- **PostgreSQL** - база данных для хранения пользователей и сессий
- **ServiceAccount** - аккаунт для запуска сервиса

## Установка

```bash
helm upgrade --install dz6-auth ./auth_chart -n auth
```

## Параметры

Основные настройки чарта находятся в файле `values.yaml`:

- `replicaCount` - количество реплик сервиса
- `image.repository` - репозиторий Docker образа
- `image.tag` - тег образа
- `service.type` - тип создаваемого сервиса
- `postgresql` - настройки базы данных

## API сервиса аутентификации

Сервис предоставляет следующие эндпоинты:

- `POST /register` - регистрация нового пользователя
- `POST /login` - вход в систему
- `POST /logout` - выход из системы
- `GET /auth` - проверка аутентификации
- `GET /signin` - обработка перенаправления для аутентификации

## Проверка работоспособности

После установки чарта проверьте статус подов:

```bash
kubectl get pods -n auth
```

## Миграции базы данных

При первом запуске автоматически выполняются миграции для создания схемы базы данных.